digraph G {

  node [style=filled, shape=box, fillcolor="#ffffcc", fontname=Sans];
  edge [fontname="Sans"];

  browser [label="browser", shape=tab, fillcolor=aliceblue];
  rp      [label="reverse proxy"];
  static  [label="static files", shape=folder, href="url to configure static files", fillcolor=lightgray];
  uwsgi   [label="uwsgi", shape=parallelogram href="https://docs.axiom.org/utils/axiom.sh.html"]
  valkey  [label="valkey DB", shape=cylinder];

  axiom1  [label="AXIOM #1", fontcolor=blue3];
  axiom2  [label="AXIOM #2", fontcolor=blue3];
  axiom3  [label="AXIOM #3", fontcolor=blue3];
  axiom4  [label="AXIOM #4", fontcolor=blue3];

  browser -> rp [label="HTTPS"]

  subgraph cluster_axiom {
      label = "AXIOM instance" fontname=Sans;
      bgcolor="#fafafa";
      { rank=same; static rp };
      rp -> static  [label="optional: reverse proxy serves static files", fillcolor=slategray, fontcolor=slategray];
      rp -> uwsgi [label="http:// (tcp) or unix:// (socket)"];
      uwsgi -> axiom1 -> valkey;
      uwsgi -> axiom2 -> valkey;
      uwsgi -> axiom3 -> valkey;
      uwsgi -> axiom4 -> valkey;
  }

}
